@defer (base.html; active_page="Library"; playing_info=playing_info) {
  <div
    class="flex flex-col"
    data-sse="tracklist"
    hx-trigger="tracklist"
    hx-get="/library/{{ tab }}"
    hx-target="this"
    hx-swap="outerHTML"
  >
    <div
      id="title" class="sticky top-0 flex max-h-full grow flex-col bg-black/80 backdrop-blur large-title"
    >
      <h1 class="text-2xl">Library</h1>
      <div
        id="fitler-tags" class="group flex justify-between *:rounded-full *:px-2 *:py-1 *:transition-colors"
      >
        <a
          href="albums"
          class="@if (tab=='albums') {filter-tag-selected}"
          preload="mouseover"
          preload-images="true"
        >
          Albums
        </a>
        <a
          href="artists"
          class="@if (tab=='artists') {filter-tag-selected}"
          preload="mouseover"
          preload-images="true"
        >
          Artists
        </a>
        <a
          href="playlists"
          class="@if (tab=='playlists') {filter-tag-selected}"
          preload="mouseover"
          preload-images="true"
        >
          Playlists
        </a>
        <a
          href="tracks"
          class="@if (tab=='tracks') {filter-tag-selected}"
          preload="mouseover"
          preload-images="true"
        >
          Tracks
        </a>
      </div>
    </div>

    @if (tab == "albums") {
      @defer (list-albums.html; albums=library.albums) {}
    }
    @if (tab == "artists") {
      @defer (list-artists.html; artists=library.artists) {}
    }
    @if (tab == "playlists") {
      <a class="button button-primary w-fit" href="/playlist/create">
        @defer (icons/plus.html) {}
        Create playlist
      </a>

      @defer (list-playlists.html; playlists=library.playlists) {}
    }
    @if (tab == "tracks") {
      @defer (
        list-tracks.html;
        click="/api/track/play";
        api_by_id=true;
        tracks=library.tracks;
        show_track_cover=true;
        show_artist=true;
        is_favorite=true
      ) {}
    }
  </div>
}
